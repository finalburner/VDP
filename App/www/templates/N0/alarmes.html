<ion-view view-title="Journal des alarmes" ng-init="Refresh()">

  <ion-nav-bar class="bar-light">
      <!-- <ion-nav-back-button class="button-clear">
          <i class="button icon-left ion-chevron-left button-clear button-dark" ></i>

        </ion-nav-back-button> -->
          <ion-nav-buttons side="left">
                  <button class="button button-icon button-clear button-positive ion-navicon navicon" menu-toggle="left"></button>
          </ion-nav-buttons>
  </ion-nav-bar>

<ion-content >
<!--Barre de recherche-->
<div class="recherche">
 <label class="item item-input search-row ">
 <i class="icon ion-search placeholder-icon"></i>
 <input type="text" placeholder="Recherche" ng-model="search">
</label></div>


<!--Bouton CT - Intervention-->
<div class="item button-bar row">
     <a class="button btn_CT" ng-click="filterencours()">En cours</a>
     <a class="button btn_Int" ng-click="filtertoutes()">Toutes</a>
     <a class="button btn_Int" ng-click="modalm_open()">Filtres</a>
</div>

<!--Liste de AL-->
<ion-refresher on-refresh="Refresh()">
</ion-refresher>
<ion-list>
    <!-- <ion-item class="row AL_Item" ng-class="isItemExpanded(item) ? 'expand-item active' : 'expand-item inactive'"
    ng-animate="'animate'" collection-repeat="item in list_AL | filter : Filter_Alm | filter : search track by item.Mnemo" class="item col"  ng-click="expand_AL(item)"   ng-class="{active: isItemExpanded(item)}"> -->
    <ion-item class="row AL_Item" ng-class="isItemExpanded(item) ? 'expand-item active' : 'expand-item inactive'"
  ng-repeat="item in List_AL | filter : filtercriticite | filter : filteretat | filter : search track by item.M+$index | orderBy : '-item.S'   " class="item col"  ng-click="expand_AL(item)"   >

<div class="col-5 AL_bar_color" style="background-color: {{::item.AL}}"></div>
<div class="col AL_col">
<div class="row AL_bar">

            <div class="col AL_type" >{{::item.M}}</div>
            <!-- <div class="col "><p class="AL_date">{{::item.date}}</p></div> -->
          <div class="col col_arrow"><i class="icon AL_bar_icon" ng-class="isItemExpanded(item) ? 'ion-chevron-down' : 'ion-chevron-down'"></i></div>
</div>

<div class="row AL_row_text"><p id="AL_Message">{{::item.S}}</p></div>
<div class="row AL_row_text"><p id="AL_Message">{{::item.L}}</p></div>
<div class="row AL_row_state">
<span ng-if="item.P==1||item.P==2">Etat : Présente</span>
<span ng-if="item.P==3">Etat : Disparue</span>
</div>
<div class="row AL_row_state">
<span ng-if="item.P==1">Ack : Acquittée</span>
<span ng-if="item.P==3||item.P==2">Ack : non Acquittée</span>
</div>
<div class="row AL_row_btn">
<button class="button button-avis" >Créer un Avis</button>
<button class="button button-ack" ng-click ="ACK(item)">Acquitter</button>
<button class="button button-voir" ng-click ="btn_voir(item.loc)">Voir</button>
</div>
</div>
          </ion-item>
</ion-list>

      <!-- <ion-list ng-controller="ALctrl">
        <div ng-repeat="item in list_AL">
          <ion-item class="item-stable row "
                    ng-click="toggleGroup(group)"
                    ng-class="{active: isGroupShown(group)}">
                    <div class="col-5 CT_bar_color"></div>
                    <div class="col">{{item.type}}</div>
                    <div class="col">{{item.date}}</div>
            <div class="col"><i class="icon" ng-class="isGroupShown(group) ? 'ion-minus' : 'ion-plus'"></i></div>
       </ion-item>
       <ion-item class="item-accordion"

                    ng-show="isGroupShown(group)">
            {{item}}
          </ion-item>
    </div>

          <!-- <ion-item class="item-accordion"
                    ng-show="isGroupShown(group)">
            {{::item.name}}
          </ion-item> -->

      <!--  -->

  </ion-content>
</ion-view>
